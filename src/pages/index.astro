---
import Layout from "../layouts/Layout.astro";
import LinkedinIcon from "../components/icons/LinkedinIcon.astro";
import GithubIcon from "../components/icons/GithubIcon.astro";
import GmailIcon from "../components/icons/GmailIcon.astro";
import Footer from "../components/Footer.astro";
import Experience from "../components/Experience.astro";
import Curriculum from "../components/icons/Curriculum.astro";
import Hero from "../components/Hero.astro";
import Proyectos from "../components/Proyectos.astro";
import Skills from "../components/Skills.astro";
---

<Layout title="Cristian Godoy - Desarrollador Fullstack">
  <main>
    <header
      class="w-full bg-gray-900 border-b border-gray-800 sticky top-0 z-50"
    >
      <div
        class="container mx-auto max-w-7xl px-4 py-4 flex justify-between items-center"
      >
        <div
          class="text-white font-bold text-xl md:text-2xl tracking-tight hover:text-accent transition-colors"
        >
          <a href="/">
            <img
              src="/logo.png"
              class="w-24 h-auto"
              alt="Cristian Godoy Angel"
            />
          </a>
        </div>

        <!-- Mobile menu button -->
        <button
          id="mobile-menu-btn"
          class="md:hidden text-white p-2 hover:text-accent transition-colors"
          aria-label="Toggle menu"
        >
          <svg
            id="menu-icon"
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg
            id="close-icon"
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 hidden"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>

        <!-- Desktop navigation -->
        <nav class="hidden md:flex gap-6">
          <a
            href="#inicio"
            class="text-gray-300 text-lg font-medium hover:text-accent transition-colors"
            >Inicio</a
          >
          <a
            href="#proyectos"
            class="text-gray-300 text-lg font-medium hover:text-accent transition-colors"
            >Proyectos</a
          >
          <a
            href="#experiencia"
            class="text-gray-300 text-lg font-medium hover:text-accent transition-colors"
            >Experiencia</a
          >
          <a
            href="#contacto"
            class="text-gray-300 text-lg font-medium hover:text-accent transition-colors"
            >Contacto</a
          >
        </nav>
      </div>

      <!-- Mobile navigation -->
      <nav
        id="mobile-menu"
        class="md:hidden hidden flex-col gap-4 px-4 pb-4 bg-gray-900 border-t border-gray-800"
      >
        <a
          href="#inicio"
          class="mobile-menu-link text-gray-300 text-lg font-medium hover:text-accent transition-colors py-2"
          >Inicio</a
        >
        <a
          href="#proyectos"
          class="mobile-menu-link text-gray-300 text-lg font-medium hover:text-accent transition-colors py-2"
          >Proyectos</a
        >
        <a
          href="#experiencia"
          class="mobile-menu-link text-gray-300 text-lg font-medium hover:text-accent transition-colors py-2"
          >Experiencia</a
        >
        <a
          href="#contacto"
          class="mobile-menu-link text-gray-300 text-lg font-medium hover:text-accent transition-colors py-2"
          >Contacto</a
        >
      </nav>
    </header>

    <Hero />

    <Proyectos />

    <Skills />

    <Experience />

    <section
      id="contacto"
      class="relative flex justify-center items-center px-4 md:px-8 lg:px-12 py-12 md:py-16 lg:py-20 overflow-hidden bg-gray-900"
    >
      <div
        id="wave-container"
        class="absolute inset-0 overflow-hidden pointer-events-none z-[9999]"
      >
      </div>

      <div class="relative w-full max-w-lg mx-4 md:mx-8 lg:m-20">
        <div class="relative"></div>

        <div class="text-center space-y-2">
          <h3 class="text-xl md:text-2xl font-bold text-accent pb-4 md:pb-6">
            Trabajemos Juntos
          </h3>
        </div>

        <div class="w-full relative">
          <button
            id="copy-btn"
            class="w-full flex items-center justify-between py-3 md:py-4 px-4 md:px-6 rounded-xl transition-all duration-200 relative overflow-hidden neu-button"
          >
            <span
              class="font-mono text-neutral-300 text-sm md:text-lg truncate mr-4 z-10 pointer-events-none"
              >cristiangodoyangel@gmail.com</span
            >

            <div
              class="flex items-center gap-2 text-accent font-bold text-xs md:text-sm z-10 pointer-events-none"
            >
              <svg
                id="btn-icon"
                class="w-4 h-4 md:w-5 md:h-5 transition-transform duration-300"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <rect
                  width="14"
                  height="14"
                  x="8"
                  y="8"
                  rx="2"
                  ry="2"
                  stroke-width="2"></rect><path
                  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"
                  stroke-width="2"></path>
              </svg>
              <span id="btn-text">Copiar</span>
            </div>
          </button>
        </div>
        <div class="flex justify-center flex-col gap-3 md:gap-4 mt-8 md:mt-10">
          <a
            href="https://linkedin.com/in/cristian-godoy-angel/"
            target="_blank"
            class="btn btn-accent btn-sm md:btn-md inline-flex flex-row items-center gap-2 hover:bg-black hover:text-white hover:scale-105 transition duration-300"
          >
            <LinkedinIcon class="w-4 h-4" />
            <span class="text-base md:text-lg">Linkedin</span>
          </a>

          <a
            href="https://github.com/cristiangodoyangel"
            target="_blank"
            class="btn btn-accent btn-sm md:btn-md inline-flex flex-row items-center gap-2 hover:bg-black hover:text-white hover:scale-105 transition duration-300"
          >
            <GithubIcon class="w-6 h-6" />
            <span class="text-base md:text-lg">Github</span>
          </a>

          <a
            href="/CV_CristianGodoy_fullstack.pdf"
            target="_blank"
            class="btn btn-accent btn-sm md:btn-md inline-flex flex-row items-center gap-2 hover:bg-black hover:text-white hover:scale-105 transition duration-300"
          >
            <Curriculum class="w-6 h-6" />
            <span class="text-base md:text-lg">Descargar CV</span>
          </a>
        </div>
      </div>
    </section>

    <style>
      .neu-button {
        --btn-bg: #171717;
        --btn-shadow-light: rgba(194, 194, 194, 0.05);
        --btn-shadow-dark: rgba(32, 87, 97, 0.8);

        background-color: var(--btn-bg-gray-900);
        border: 1px solid rgba(255, 15, 15, 0.05);
        box-shadow:
          6px 6px 12px var(--btn-shadow-dark),
          -4px -4px 10px var(--btn-shadow-light);
        z-index: 10;
      }

      .neu-button.clicked {
        animation: btnSink 0.5s ease-out forwards;
      }

      @keyframes btnSink {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(0.98);
        }
        100% {
          transform: scale(1);
        }
      }
    </style>

    <style is:global>
      .wave {
        z-index: 50;
        position: absolute;

        border-radius: 0.75rem;

        box-shadow:
          0 0 20px #009689,
          inset 0 0 20px #009689;

        opacity: 0;
        pointer-events: none;

        animation:
          fadeIn 0.2s ease-out forwards,
          outside_grow 1.5s ease-out forwards,
          fadeOut 1s 0.5s forwards;

        transform: translate(-50%, -50%);
        border-radius: 0.75rem;
      }

      @keyframes outside_grow {
        from {
          width: var(--start-w);
          height: var(--start-h);
        }
        to {
          width: calc(var(--start-w) + 500px);
          height: calc(var(--start-h) + 500px);
        }
      }

      @keyframes inside_grow {
        from {
          width: 0;
          height: 0;
        }
        to {
          width: calc(var(--start-w) + 480px);
          height: calc(var(--start-h) + 480px);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }
    </style>

    <script>
      // Mobile menu toggle
      const mobileMenuBtn = document.getElementById("mobile-menu-btn");
      const mobileMenu = document.getElementById("mobile-menu");
      const menuIcon = document.getElementById("menu-icon");
      const closeIcon = document.getElementById("close-icon");
      const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");

      if (mobileMenuBtn && mobileMenu && menuIcon && closeIcon) {
        mobileMenuBtn.addEventListener("click", () => {
          const isHidden = mobileMenu.classList.contains("hidden");

          if (isHidden) {
            mobileMenu.classList.remove("hidden");
            mobileMenu.classList.add("flex");
            menuIcon.classList.add("hidden");
            closeIcon.classList.remove("hidden");
          } else {
            mobileMenu.classList.add("hidden");
            mobileMenu.classList.remove("flex");
            menuIcon.classList.remove("hidden");
            closeIcon.classList.add("hidden");
          }
        });

        // Close menu when clicking on a link
        mobileMenuLinks.forEach((link) => {
          link.addEventListener("click", () => {
            mobileMenu.classList.add("hidden");
            mobileMenu.classList.remove("flex");
            menuIcon.classList.remove("hidden");
            closeIcon.classList.add("hidden");
          });
        });
      }

      // Copy button functionality
      const copyBtn = document.getElementById("copy-btn");
      const btnText = document.getElementById("btn-text");
      const waveContainer = document.getElementById("wave-container");

      let isAnimating = false;

      if (copyBtn && waveContainer && btnText) {
        copyBtn.addEventListener("click", () => {
          if (isAnimating) return;
          isAnimating = true;

          navigator.clipboard.writeText("cristiangodoyangel@gmail.com");

          const originalText = btnText.innerText;
          btnText.innerText = "Â¡Copiado!";
          btnText.classList.add("text-white");
          copyBtn.classList.add("clicked");

          const btnRect = copyBtn.getBoundingClientRect();
          const containerRect = waveContainer.getBoundingClientRect();

          const x = btnRect.left + btnRect.width / 2 - containerRect.left;
          const y = btnRect.top + btnRect.height / 2 - containerRect.top;

          createWave(x, y, btnRect.width, btnRect.height);

          setTimeout(() => {
            copyBtn.classList.remove("clicked");
            isAnimating = false;
            setTimeout(() => {
              btnText.innerText = originalText;
              btnText.classList.remove("text-white");
            }, 1000);
          }, 400);
        });
      }

      // @ts-ignore
      function createWave(x, y, width, height) {
        if (!waveContainer) return;

        const wave = document.createElement("div");
        wave.classList.add("wave");

        wave.style.left = `${x}px`;
        wave.style.top = `${y}px`;

        wave.style.setProperty("--start-w", `${width}px`);
        wave.style.setProperty("--start-h", `${height}px`);

        waveContainer.appendChild(wave);

        setTimeout(() => {
          wave.remove();
        }, 2000);
      }
    </script>

    <!-- YouTube Modal -->
    <div
      id="youtube-modal"
      class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4"
    >
      <div
        class="relative w-full max-w-5xl bg-gray-900 rounded-2xl shadow-2xl overflow-hidden"
      >
        <!-- Close button -->
        <button
          id="close-modal"
          class="absolute top-4 right-4 z-10 w-10 h-10 flex items-center justify-center bg-red-600 hover:bg-red-700 text-white rounded-full transition-all duration-300 hover:scale-110 shadow-lg"
          aria-label="Cerrar modal"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>

        <!-- Video container -->
        <div class="relative w-full" style="padding-bottom: 56.25%;">
          <iframe
            id="youtube-iframe"
            class="absolute top-0 left-0 w-full h-full"
            src=""
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>
        </div>
      </div>
    </div>

    <script is:inline>
      // YouTube Modal functionality
      const modal = document.getElementById("youtube-modal");
      const iframe = document.getElementById("youtube-iframe");
      const closeBtn = document.getElementById("close-modal");
      const youtubeLinks = document.querySelectorAll(".youtube-link");

      // Open modal with video
      youtubeLinks.forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const videoUrl = link.getAttribute("data-video-url");
          // Convert YouTube URL to embed URL
          const videoId = videoUrl.split("/").pop();
          iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
          modal.classList.remove("hidden");
          modal.classList.add("flex");
          document.body.style.overflow = "hidden";
        });
      });

      // Close modal
      function closeModal() {
        modal.classList.add("hidden");
        modal.classList.remove("flex");
        iframe.src = "";
        document.body.style.overflow = "auto";
      }

      closeBtn.addEventListener("click", closeModal);

      // Close modal when clicking outside
      modal.addEventListener("click", (e) => {
        if (e.target === modal) {
          closeModal();
        }
      });

      // Close modal with Escape key
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && !modal.classList.contains("hidden")) {
          closeModal();
        }
      });
    </script>
  </main>
  <Footer />
</Layout>
