---
import LinkedinIcon from "../components/icons/LinkedinIcon.astro";
import GithubIcon from "../components/icons/GithubIcon.astro";
import GmailIcon from "../components/icons/GmailIcon.astro";
import Curriculum from "../components/icons/Curriculum.astro";
---

<section
  id="contacto"
  class="relative flex justify-center items-center px-4 md:px-8 lg:px-12 py-12 md:py-16 lg:py-20 overflow-hidden bg-base-200"
>
  <div
    id="wave-container"
    class="absolute inset-0 overflow-hidden pointer-events-none z-[9999]"
  >
  </div>

  <div class="relative w-full max-w-lg mx-4 md:mx-8 lg:m-20">
    <div class="relative"></div>

    <div class="text-center space-y-2">
      <h3 class="text-xl md:text-2xl font-bold text-accent pb-4 md:pb-6">
        Trabajemos Juntos
      </h3>
    </div>

    <div class="w-full relative">
      <button
        id="copy-btn"
        class="w-full flex items-center justify-between py-3 md:py-4 px-4 md:px-6 rounded-xl transition-all duration-200 relative overflow-hidden neu-button"
      >
        <span
          class="font-mono text-gray-900 text-sm md:text-lg truncate mr-4 z-10 pointer-events-none"
          >cristiangodoyangel@gmail.com</span
        >

        <div
          class="flex items-center gap-2 text-accent font-bold text-xs md:text-sm z-10 pointer-events-none"
        >
          <svg
            id="btn-icon"
            class="w-4 h-4 md:w-5 md:h-5 transition-transform duration-300"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <rect
              width="14"
              height="14"
              x="8"
              y="8"
              rx="2"
              ry="2"
              stroke-width="2"></rect><path
              d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"
              stroke-width="2"></path>
          </svg>
          <span id="btn-text">Copiar</span>
        </div>
      </button>
    </div>
    <div class="flex justify-center flex-col gap-3 md:gap-4 mt-8 md:mt-10">
      <a
        href="https://linkedin.com/in/cristian-godoy-angel/"
        target="_blank"
        class="btn btn-accent btn-sm md:btn-md inline-flex flex-row items-center gap-2 hover:bg-black hover:text-white hover:scale-105 transition duration-300"
      >
        <LinkedinIcon class="w-4 h-4" />
        <span class="text-base md:text-lg">Linkedin</span>
      </a>

      <a
        href="https://github.com/cristiangodoyangel"
        target="_blank"
        class="btn btn-accent btn-sm md:btn-md inline-flex flex-row items-center gap-2 hover:bg-black hover:text-white hover:scale-105 transition duration-300"
      >
        <GithubIcon class="w-6 h-6" />
        <span class="text-base md:text-lg">Github</span>
      </a>

      <a
        href="/CV_CristianGodoy_fullstack.pdf"
        target="_blank"
        class="btn btn-accent btn-sm md:btn-md inline-flex flex-row items-center gap-2 hover:bg-black hover:text-white hover:scale-105 transition duration-300"
      >
        <Curriculum class="w-6 h-6" />
        <span class="text-base md:text-lg">Descargar CV</span>
      </a>
    </div>
  </div>
</section>

<style>
  .neu-button {
    --btn-bg: #171717;
    --btn-shadow-light: rgba(194, 194, 194, 0.05);
    --btn-shadow-dark: rgba(32, 87, 97, 0.8);

    background-color: var(--btn-bg-gray-900);
    border: 1px solid rgba(255, 15, 15, 0.05);
    box-shadow:
      6px 6px 12px var(--btn-shadow-dark),
      -4px -4px 10px var(--btn-shadow-light);
    z-index: 10;
  }

  .neu-button.clicked {
    animation: btnSink 0.5s ease-out forwards;
  }

  @keyframes btnSink {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(0.98);
    }
    100% {
      transform: scale(1);
    }
  }
</style>

<style is:global>
  .wave {
    z-index: 5;
    position: absolute;

    border-radius: 0.75rem;

    box-shadow:
      0 0 10px #8f8f8f,
      inset 0 0 20px #027579;

    opacity: 0;
    pointer-events: none;

    animation:
      fadeIn 0.2s ease-out forwards,
      outside_grow 1.5s ease-out forwards,
      fadeOut 1s 0.5s forwards;

    transform: translate(-50%, -50%);
    border-radius: 0.75rem;
  }

  @keyframes outside_grow {
    from {
      width: var(--start-w);
      height: var(--start-h);
    }
    to {
      width: calc(var(--start-w) + 500px);
      height: calc(var(--start-h) + 500px);
    }
  }

  @keyframes inside_grow {
    from {
      width: 0;
      height: 0;
    }
    to {
      width: calc(var(--start-w) + 480px);
      height: calc(var(--start-h) + 480px);
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes fadeOut {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }
</style>

<script>
  const mobileMenuBtn = document.getElementById("mobile-menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");
  const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");

  if (mobileMenuBtn && mobileMenu && menuIcon && closeIcon) {
    mobileMenuBtn.addEventListener("click", () => {
      const isHidden = mobileMenu.classList.contains("hidden");

      if (isHidden) {
        mobileMenu.classList.remove("hidden");
        mobileMenu.classList.add("flex");
        menuIcon.classList.add("hidden");
        closeIcon.classList.remove("hidden");
      } else {
        mobileMenu.classList.add("hidden");
        mobileMenu.classList.remove("flex");
        menuIcon.classList.remove("hidden");
        closeIcon.classList.add("hidden");
      }
    });

    mobileMenuLinks.forEach((link) => {
      link.addEventListener("click", () => {
        mobileMenu.classList.add("hidden");
        mobileMenu.classList.remove("flex");
        menuIcon.classList.remove("hidden");
        closeIcon.classList.add("hidden");
      });
    });
  }

  const copyBtn = document.getElementById("copy-btn");
  const btnText = document.getElementById("btn-text");
  const waveContainer = document.getElementById("wave-container");

  let isAnimating = false;

  if (copyBtn && waveContainer && btnText) {
    copyBtn.addEventListener("click", () => {
      if (isAnimating) return;
      isAnimating = true;

      navigator.clipboard.writeText("cristiangodoyangel@gmail.com");

      const originalText = btnText.innerText;
      btnText.innerText = "Â¡Copiado!";
      btnText.classList.add("text-white");
      copyBtn.classList.add("clicked");

      const btnRect = copyBtn.getBoundingClientRect();
      const containerRect = waveContainer.getBoundingClientRect();

      const x = btnRect.left + btnRect.width / 2 - containerRect.left;
      const y = btnRect.top + btnRect.height / 2 - containerRect.top;

      createWave(x, y, btnRect.width, btnRect.height);

      setTimeout(() => {
        copyBtn.classList.remove("clicked");
        isAnimating = false;
        setTimeout(() => {
          btnText.innerText = originalText;
          btnText.classList.remove("text-white");
        }, 1000);
      }, 400);
    });
  }

  // @ts-ignore
  function createWave(x, y, width, height) {
    if (!waveContainer) return;

    const wave = document.createElement("div");
    wave.classList.add("wave");

    wave.style.left = `${x}px`;
    wave.style.top = `${y}px`;

    wave.style.setProperty("--start-w", `${width}px`);
    wave.style.setProperty("--start-h", `${height}px`);

    waveContainer.appendChild(wave);

    setTimeout(() => {
      wave.remove();
    }, 2000);
  }
</script>
